version: '2'

services:
  ghost:
    image: ghost
    env_file: .env
    volumes:
     - ./content:/usr/src/ghost/content
     - ./config:/var/lib/ghost
    ports:
     - "2368:2368"
    restart: always

  buster:
    image: raccoony/buster
    links:
      - ghost
    depends_on:
      - ghost
    volumes:
      - ~/.ssh/id_rsa:/root/.ssh/id_rsa
      - ~/.ssh/known_hosts:/root/.ssh/known_hosts
    env_file: .env
    environment:
      - VIRTUAL_HOST=${GITHUB_ID}.github.io
      - PUBLIC_URL=${GITHUB_ID}.github.io
      - GIT_REPO=git@github.com:${GITHUB_ID}/${GITHUB_ID}.github.com.git
    ports:
      - "9000:9000"
